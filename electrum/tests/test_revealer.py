from electrum.plugins.revealer.revealer import RevealerPlugin

from . import ElectrumTestCase


class TestRevealer(ElectrumTestCase):

    def test_version_0_noisemap(self):
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input(
            "03b0c557d6d0d4308a3393851d78bd8c7861"
        )
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for (x, y), pixel in noise_map.items():
            if pixel:
                bigint |= 1 << (y * RevealerPlugin.SIZE[1] + x)
        self.assertEqual(
            0x541DDE00B20AC7D320510E943D7ED9FFFF5FF6B431C915353FBEFFBC1BEB737FF3A59C032A39FF8CBD532DFFE42655BCCBBEF4F777FFEFF8EC90E64AACBFF5F4FF37EF4F32AC1D7240ED2BBB37DFEFF459C7C2E2E0BFDDFFFF7FFFC7FD27EEB84A5CEAFCF6BF9FFAFF632367F97FFFBF9FBFECFF2B3A11A1C5BEFDFBFE7F125FBA2C3E5D4DED591F9FBBBADBEED2220FB4337DF9E4C7BFBE6CE4AD7B18AD57F3D75DFE7B6DEB7350478BDBF7B7BFDF776EB301217D1F5C7F7FFFFEEFFFE2070F52DBEDFFF2FEF7F27F7D27F80B6A7BFB7F67BCBF7FAF11F6B577DFBEFEBD44FFFFE7BF5EE17BA4FB3377E1FCFFEDED781ECA37A5BFF3EBEFDCCBE1538C16129AED7FADFD7EB3BAB55BCBDAEE7E5D5B9FFF57BD662333923B27AF4F4DA5FFD8BB15B58EFFED8BBEEFF9AB7ECB75B62B977FDD88F3FBAEEF6997A999B4DFFFBFA375BF9E9C12B6011E2FDE9FEF7F66EFC1155CC4FEDFEEFFFEEFF6DED645712B12BFE2B35DF796F7CA05E0F12AFBFF6FEFD1DD7F736BB9A567DFF5797EAFC1BFA0CF6CD090DDDDFBFB79FD9F7F17BBA2197E5DD3FB7FD9FF7579F0B6E28F7DF3BDFE6FA8EFD5A0A2E48F4D6EFFF79BF5EFEBC2638FF7EEFFFBBDFDB5BFAC80426052DF6FE6FD33EFF5336A3C87C9FCFF797B6BDDBF91FEA62E635333FFD7BFDD35F5C365432F5DFE7FD8BFB6C6E7CC90E6B5796D1DFEEF567FDF390124A4BFEEFD7EFD1EEE7F88CA45658FBF5CABFFBFEBF9FEFE2C9F73DBFFD36D7DF77D73665C5F1DFA7B5B7FFFAFB6EA18BF9396E37B77FFFFFFFB6AEFDB0635FF7E43CFEEF77FD8A527741DD3FFFEF1EDDEDF7F4259CC4253FFD9DFFFFB3BFBB0632D3D7FBF7BFBBFEDFFF2A7589BE7624FAFFFFBDBD7DFB5B5189B66FDE8ABF8BFBBA7F440B80C2BA86DE5FDFDF7FFBA25625877FB9FDBF6F39333FE20E7710CDFFADEF8E7FB727D059237EF3DFCEB9BD7FFEF7B041565F2BB7FFDFEFFFFF1BA3C7ABB9A0FCF3FDF78FEE7EFB5DA83DD1FFADEBDE675FF36D725426027DFFFD9F76DF3F7605B7F6FA4F75FF6E3DF57FFD1A56C6239FEFFEBFFEECFFDBD1ECC69F99FFEA7F5EC759E2B2A99977B467EDBFFAFAE5FAEF9E719B7BFF73FE9FED753DDC20BA23D8E7FDF4ADFDBEFADBB6A6775F7EF7EDDFFDFFFEEAD7BE0B38DCEFEEB6AFFFEF3D272D1B0492E733FFF15DC3BFA2BFB83B9FEFBFDF853FBDDFBDBDF354868FD6DEDF93EDFFCA29130013BFCFBE27F4FEFFC86BBAA925BFFDEED3FEDE76B321DC0ABB57FE367DF5ADAAF30CC615C1EFEF7FBFFE3993E583FF3721BDFBE66EDEF8FAEF24697F311FF6FF57FFEFBEBFF9B90325BDA76F77DAEABFBCB9ABD45C0BFFE576BC3FFFFFC96911D477DDBBC3FEEF7F63A4510EC1265E6E1FE765EAAFBCA10400876BFF7BFFDFDFFCC9920F60119BEEDFFFD57E6FF383E6C3637DEF9FDFFB7BFFFB3339F94EB3FDF5BD7BBDFDF621D8F008DAD195DFFD6FFBFF57A1CE166E5EF9F85FEBDDE28A4A013987BF7FFEBFFFFB56CF7AA522589BDAFDF51FF4F39ED386097667FAFDBFFFFF7EF9379DBC136BEDFB9FF7AEFFFC3F081BE97BF4E7ECFBDE35CEA3018D1BF1BFFBFAEEBEFB9FAC072F05BAC77F7FDFFEFFE2EB1BD4D90A6FDDAFD7C2FF7BF9BA80D6F6DF77CE727FF9A97FB41F03DCFBC557B3FBCC80B,
            bigint,
        )

    def test_version_1_noisemap(self):
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input(
            "125Df05b7ccf079ce2978Ae18e99219868cd"
        )
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for (x, y), pixel in noise_map.items():
            if pixel:
                bigint |= 1 << (y * RevealerPlugin.SIZE[1] + x)
        self.assertEqual(
            0x36FDE1EECE10B3F674227EA76F7ABABBCBF87DFBA1EDDF2EDEBFEEFEC3DFFFF719EE1CBD477B9BE7CF6FCDAFF924FF05A26FF2FB7BFDBBDEF1A2F90C097D7CDADFBB9D1EF592C27C85EFFFFFFF7FFC8DFF60D6DE87F71C9FE77F7F5372CFDB1DC0EB9E959DBED42197C7EE4288F7FBF73B65FDFBD5E153EDE49BB957EDAEFE6F7DEE4A72502EEF77BABFA7FFF7D0A3FC6F5FFEFB3B7B67AAB66118A56EB1FFFE1DDAFBEEFEFA96B26D715BB8E5FAFBBB2FFCF64E8DF2BDFFEFFED39FFDFDEF986491A7FBF97BFFB7FAFEE072640B7AF6EDF8DA2F7CDFF268CCD52B75F53F9AFEF77B4BE4DB9C5F9DEBFFEFF5F7F1F7B1882CB4EED67F757B37EBF0B2C7F849BD73F4737F3FFB5A3F75AC537FF5FFF8EDCDFEB6BE63D3147FFEEFA9CAF7EBF740989520C1EDDEDABDFD73F7F821FC3977FDFBE9FBEE7D6E8CA9F16B8B8F1DECBFFEF17F806ADE988D77FEF5775CFF3F7BD9759675F4773FFF6FEFAFF385FE807FDBFCBBFFEFA6D7C4ED54A0D1959CEFEECFFDFFE8CD539451DFDFBFF71FF7E97CF37AEC8069EFFFCF7536EBBC515E991CF293FF97FEFFD72CEBE110D44BF787F1EFECDA7306AC88CD49DFFF257CBD9FF7FF8FD1686EEDF2DFEB373FBE2A10ED81F7D9C979316EFCEEEA745926377FFCFFBA7EDF67FC79CACE0EEEF5FF5CEFFEEEFF94D20C4DADD53EFEE6F97BFED2F8AE059FF7FFBFEDFBF17F2D45BC8AFDEBF1DFF7856EBD02C39AE22EF7BEFC9E97CBB7F31AF5BD57E3FEFFAFC4D7FEF9AE222E9FDCF5A2DFBFFEFD50399D7D095D22FD7BF9FDEF6D5D5044BAFFFDFD57FFF7CBE6AF91096B3F5FFFE3FFF7FB97FA930D316DB6DFBF236DDBC8ABB3BBEA6EDF9DEAFD39B8EFAC7AE014E7FFBDD97CFEBE7EC84A72A7B323FE77AFFFD7F1C8EAEC48E6FF3FDF7DA9FFFAF2D57E961D7F5DEBC9AFE7FF32D72FF374D3FF57FFF2FBFFDBE9833405FCBABFF8BEB8FF1E55F53B2D6E96BDF7E7FBFD0FB6B130071C13CF5DE5BE5EF8ADE46A2DD53D77FF69EFF7FF946AD4E32FEBDDFF87B73FCEEAF2CE94ADAFBB9FDDEFF8FBF11F4161AD6CB29DBE5F2FFE6EE2023CEEB79C76D7FFF7BBFFAF4485B6F6F3B7F97F9F75CE372C173177FEDD65E5FB76FDC5BBF7A737F9BDDDEFEFFF1F7A5533DD1EFDE7FFAFABCD96E1193E3CADB93E76FCDFDB4FA533BC3D3A7EFF5EEBC9F3FFCE91AA51BBF5E7F6BCFD7DFBFD1928C0726F3F26EF8F3FFE2EB8843CBB1DFD2EABFE4F7FFEC47A95263E5C65737AFFE73E3E3735D61E8CBFFDBF75E37FC04A991AD7FF7FEFFA6FAFDFED988B50FDF379FFDFFF2F7EEB6738C0CEFFFF77F32FE7F2B22C866514DB75F7C3DF6E5FD210A70BB4BBF31BCFB6D325F4A00B06ED7D34C9DBBDFFFF3FD6FD8ED570D7DEF1DCF789FF5AE040339FF35DEB5E37BEDF889D83BCF5FEFFB77E57FFCFDD8EDFD91BB8BFFD3B7DBD8FEA3083734C3D7DEDD9FFEFCB78C5D87E1919F5655BF5BF1BFB3DD65FB64EE2FFFD777AFEF18965D03872D73BBFB6FA7DF7250F3E8D6EF7FF9FFFFEADFF5E39ABF8727FDE93FEBDDFFFEE3096CA1779CEABBF7FF7BDA2F756353BE9DFABF2BCFF6FEEC1CAD233FFFBF9ECEFFFFFA21B7B8B17FFDED7FF7FEF56EE44B02D9BDF3D3CF42AA777FD90BA9B08AF4CFD5B797DADB3694BF3282ABCB39FB2D760F9,
            bigint,
        )

    def test_version_1_noisemap_indexerror(self):
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input(
            "1A082CBDC627FFA37ABD154A64AD2565D725"
        )
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for (x, y), pixel in noise_map.items():
            if pixel:
                bigint |= 1 << (y * RevealerPlugin.SIZE[1] + x)
        self.assertEqual(
            0x20BDBA94D80B604107D92E4BB77FBDFF66CBD769D14D31CC26FDBB77FFFFF237DB49C1CB6BF5CFD4FBB7E169DFC0213B57FFBF7E7FB3DFFBDCE1F92BBB595EFFFBEFEEB06E00CD6FBFCF5572E6D4F376843FED920475DFDAD7DBFFFEDF1F5FB9DE7F67FF77AEFEFB753DAEBCE8EEB77FF7E35EAEEFAF48FE37C7FD71ECFA96FAF6D49BD1B60E29CBFF7FF2F5FE7DAA83D231EFDFDFC2FFD17887D9AA79B1713F16DFCF75F7FA1E64C574B7ABBEA7ABFFF9C0E27B9F55CBDEDFFBFF3EFF95508796EB8BBF9DFFFC367F9B6B1B59337FFEBF3FF9FECDFFD61A6FEBBC3AAFFF379DBAFCFC814C56BFAFFDD1FB7FFEB35A1C293E9F393E35B5D70FBECA50020427DB9ECABAF3FFF9A2211EE279FDFFB53973FBBEFA0D2D9270FE2FEF5FFBAFFEFD753CC251EBFF7FF352E3F77FDD50BD3975EE3FFCDFF6F5FE199284436D7ADFBFFBBFAF9EFABDE086FE79BFDF21FB7EFBA8079B7EAE57FFBABFF97B3E7463300E53FF5FD5F295FFE7340062F84F689DADFD3FF13FEAEF33D83EF7FA9AEA65FFF1F53021F5BAEF9FFDDFBFBF5DFF0AD38328F03EBFADFCFFDFFDC45E2A9A1EF64FBE4F1B7F7FB567039BAAFFFDFFED87F7BB8784F28E7DFFD7D7FBFFF2E7C0D13CF0D7FF77BAFFEFBF73F6FE851607EF9FB5BF7FD5E8FE0D07D6E9BF7DE7EFFD3B7CBD8E55336E7FEF8FCBC67FB9A74BA6481D7DFDC6F3FEDD3FFE87E7184216DCFFD7DFEF7B7A6024B2C4D5FFC72D99D7CD5FF6DA6717ECF2FFFFCEFFB6E686A4FB4D57FBCEBF7EF9B3AE4C5A553340BAFFF7F7377BFFBE3DAE1FB43B738AC7EBD5DFED0C8537FE4B0DDC277B7FFBEFF63C618BEBCDFFE9BDFF6F9E52BE359A5FEAC691FFBCDF6ABB62102B09FA66F9FFAFD4B7F73D88A81E3FF2BE4B7F7FEBA2A2566203F7AF53EF7253EBF64AC799FF9E7DCFF7FADADBFFD23FC9B2FD9EFECAEAFFCFF04EFA1E0866FE1F9379FFAED4B9792AF1B63FFFCEED58FCFF21BAC450BB7FFD9AEBEFFEF5D6525510A55B5FFFFEF78F7BFA1C94FF7F3D7FCBE3DF7D3FBC5A0F710157BEFDEFF762EDF2BCFED7FB7EF96FF17DD6BDDB9DCF01126DFEE1F5B33BF1EF3C4C21C13FFBFBFD985FBFD3804539D95BA5DEF9DFCDCEB7B17C6BF29DF6DBEFBE7FB9FD9F4FD39A8FB4727B87EE579D88721C9BB3F7FFFFB7FFD9DF369DACA81D57D5FFD0BFDEFFAF1434FFCB5B6AF7F7EDDEBDBE403B7D4ABFEC6F719F6B9FEE205DA43D79FDEF7C7DBFDEF2F0F61B98FB39EFB43CF7EEEE082D36101ABB73D9EFFBBF77DC474F6F47FBBEBB1F36B76DF0DFFA846EFEDBB7AFFDFBF77222153DFF7FDD7DFFFF5E81F3B5A8EE07FF3BDFE9B77EF1FECABD51C4EF272FEFFEBEEFEA7334E38D7FC5EFFCE7FFACCFFDD18506BEE13BFFDDEFBD4F092FBF6E57DDDFBFD7FEFDF78303790E7B1BEFC77F6BBCBF9348C44B37FBEE7FEEBFFB57217373B0FEBEF97EFFEB29FF79DAAD6DF17F7FEDFDE7EEFF727C6B54217FCFBB56FFEEFFBC492064AD04CFF6FF9B7C2EFE308364110873875BFF4BB73F5C2666500AFBDBBC75FF9BEBC5BE4465EAFBBFFB7FF7B7FDC8BB7DEE0747DF7FCFD76A4BFE5E698AA3F37FE2BFFBFFB65B780150337EFB7A21FDFB747D14FD95CEEFD7F7CFE0F6DB3C0CA5EB52FB7FE82FF7F7ACDEA3F9DDABF48CEEC4CE41BB13,
            bigint,
        )
